<!-- output file generated by BM Utilities -->
<html>
<head>
<title>
IBM Certification Study Guide  AIX V4.3 System Support
</title>
</head>
<body bgcolor=#f0f0f0><a name="htmltop"></a>
<p><a href="./5139fm.htm#toc33603"><img src="f2htoc.gif"></a>
<a href="./5139indx.htm"><img src="f2hindex.gif"></a>
<a href="5139c72.htm#htmlbot"><img src="f2hbot.gif"></a>
<a href="5139c71.htm#htmlbot"><img src="f2hprev.gif">7.1  Software Service Aids
Package</a><br>

<h2><a name="9pdH3">7.2  Error Logging Facility</a>
</h2>

<p>The error logging facility records hardware and software failures in the
error log for informational purposes or for fault detection and corrective
action. The error logging subsystem is composed of three components whose
processing flow is shown in <a href="#14140">Figure 92</a>. The type of tasks
are defined as follows.
<dl>
<dt>
<b>Error Log Programming </b>
<dd>Used by developers to create error templates and create messages.
<dt>
<b>Error Processing </b>
<dd>Invoked when an error occurs.
<dt>
<b>Error Log File Processing </b>
<dd>Used by administrators to diagnose a problem.
<br><br><a name=14140>
<br>
<img src="9pdf12.gif"></a>
<br><i>Figure 92: Error Logging Subsystem Overview</i><br><br>
</dl>

<h3><a name="9pdH5">7.2.1  Managing Error Log</a>
</h3>

<p><a name=index721>The</a> following sections discuss various error log
management related functions.

<h4><a name="9pdH6">7.2.1.1  Configuring an Error Log File
(/var/adm/ras/errlog)</a>
</h4>

<p><a name=index723>This</a> section discusses the use of <tt>errdemon</tt>
command to customize the error log file.
<ul>
<li>To list the current values for the error log file name, error log file
size, and buffer size that are currently stored in the error log configuration
database settings, use the following command.
<pre>
<b># /usr/lib/errdemon -l</b>
Error Log Attributes
--------------------------------------------
Log File                /var/adm/ras/errlog
Log Size                4096 bytes
Memory Buffer Size      8192 bytes
</pre>
<p>The preceding example shows the default error log file attributes. The log
file size cannot be made smaller than the hard-coded default of 4 KB and the
buffer cannot be made smaller than the hard-coded default of 8 KB.
<p><li>To change <a name=index729>the</a> log file name to
/var/adm/ras/errlog.test, use the following command.
<p><tt>/usr/lib/errdemon -i /var/adm/ras/errlog.test</tt>
<p><li>To change the log file size to 8 MB, use the following command.
<pre>
/usr/lib/errdemon -s 8192
</pre>
<p>If the log file size specified is smaller than the size of the log file
currently in use, the current log file is renamed by appending .old to the file
name and a new log file is created with the specified size limit. The amount of
space specified is reserved for the error log file and is not available for use
by other files. Therefore, you should be careful not to make the log
excessively large. But, if you make the log too small, important information
may be overwritten prematurely. When the log file size limit is reached, the
file wraps. That is, the oldest entries are overwritten by new entries.
<p><li>To change the size <a name=index731>of</a> the error log device driver's
internal buffer to 16 MB, use the following command.
<pre>
<b># /usr/lib/errdemon -B 16384</b>
0315-175 The error log memory buffer size you supplied will be rounded up to a multiple of 4096 bytes.
</pre>
<p>If the specified buffer size is larger than the buffer size currently in
use, the in-memory buffer is immediately increased and if the specified buffer
size is smaller than the buffer size currently in use, the new size is put into
effect the next time the error daemon is started after the system is rebooted.
The size you specify is rounded up to the next integral multiple of the memory
page size (4 KB).
<p>You should be careful not to impact your system's performance by making the
buffer excessively large. But, if you make the buffer too small, the buffer may
become full if error entries are arriving faster than they are being read from
the buffer and put into the log file. When the buffer is full, new entries are
discarded until space becomes available in the buffer. When this situation
occurs, an error log entry is created to inform you of the problem.
<p>The following command shows the new attributes of error log file.
<pre>
<b># /usr/lib/errdemon -l</b>
Error Log Attributes
--------------------------------------------
Log File                /var/adm/ras/errlog.test
Log Size                8192 bytes
Memory Buffer Size      16384 bytes
</pre>
</ul>

<h4><a name="9pdH7">7.2.1.2  Starting the Error Logging Daemon</a>
</h4>

<p>To determine if error logging daemon <a name=index733>is</a> on or off,
issue the <tt>errpt</tt> command. The <tt>errpt </tt>command output may contain
entries as shown in <a href="#35721">Figure 93</a>.
<br><br><a name=35721>
<br>
<img src="9pdi17.gif"></a>
<br><i>Figure 93: errpt Command </i><br><br>
<p>If the <tt>errpt</tt> command does not generate entries, error logging has
been turned off. To activate the daemon use the following command.
<pre>
/usr/lib/errdemon
</pre>
<p>The errdemon daemon starts error logging and writes error log entries in the
system error log.

<h4><a name="9pdH9">7.2.1.3  Stopping the Error Logging Daemon</a>
</h4>

<p>To stop the error logging daemon from logging entries use the following
command.
<pre>
/usr/lib/errstop
</pre>

<h4><a name="24781">7.2.1.4  Cleaning an Error Log</a>
</h4>

<p>Cleaning of the error log implies deleting old or unnecessary entries from
the error log. Cleaning is normally done as part of the daily <tt>cron
</tt>command execution (see <a href="5139che.htm#33166">Chapter 14.  The cron
Daemon and crontab</a> for more information on cron). If it is not done
automatically, you should probably clean the error log regularly.
<p>To delete all the entries from the error log, use the following command:
<pre>
errclear 0
</pre>
<p>To selectively remove entries from the error log, for example, to delete all
software errors enteries use the following command:
<pre>
errclear -d S 0
</pre>
<p>Alternatively, use the SMIT fast path command (<tt>smit errclear) </tt>that
will display the screen as shown in <a href="#11912">Figure 94</a> and enter
appropriate fields as per requirement to clean the error log.
<br><br><a name=11912>
<br>
<img src="9pdi18.gif"></a>
<br><i>Figure 94: SMT errclear Command</i><br><br>

<h4><a name="9pdH12">7.2.1.5  Generating an Error Report</a>
</h4>

<p><a name=index742>The</a> <tt>errpt </tt>command generates the default
summary error report that contains one line of data for each error. It includes
flags for selecting errors that match specific criteria. By using the default
condition, you can display error log entries in the reverse order they occurred
and were recorded. By using the - c (concurrent) flag, you can display errors
as they occur. You can use flags to generate reports with different formats.
Following is the syntax of the <tt>errpt</tt> command.
<p><tt>errpt [ -a ] [ -c ] [ -d </tt><i>ErrorClassList</i> <tt>] [ -e
</tt><i>EndDate</i> <tt>] [ -g ] [ -i </tt><i>File </i><tt>] [ -j
</tt><i>ErrorID </i><tt>[ ,</tt><i>ErrorID</i> <tt>] ] | [ -k </tt><i>ErrorID
</i><tt>[ ,</tt><i>ErrorID</i> <tt>] ] [ -J </tt><i>ErrorLabel</i> <tt>[
,</tt><i>ErrorLabel </i><tt>] ] | [ -K </tt><i>ErrorLabel</i> <tt>[
,</tt><i>ErrorLabel</i> <tt>] ] [ -l </tt><i>SequenceNumber </i><tt>] [ -m
</tt><i>Machine</i> <tt>] [ -n </tt><i>Node </i><tt>] [ -s
</tt><i>StartDate</i> <tt>] [ -F </tt><i>FlagList</i> <tt>] [ -N
</tt><i>ResourceNameList</i> <tt>] [ -R </tt><i>ResourceTypeList</i> <tt>] [ -S
</tt><i>ResourceClassList</i> <tt>] [ -T </tt><i>ErrorTypeList</i> <tt>] [ -y
</tt><i>File </i><tt>] [ -z </tt><i>File</i> <tt>]</tt>
<p>The output of <tt>errpt</tt> command <a name=index745>without</a> any flag
will display the error log enteries with the following fields.
<dl>
<dt>
<b>IDENTIFIER</b>
<dd>Numerical identifier for the event.
<dt>
<b>TIMESTAMP</b>
<dd>Date and time of the event occurrence.
<dt>
<b>T</b>
<dd>Type of error. Depending upon the severity of the error, the following are
the possible error types:
<dl>
<dt>
PEND
<dd>The loss of availability of device or component is imminent.
<dt>
PERF
<dd>The performance of the device or component has degraded to below an
acceptable level.
<dt>
PERM
<dd>Most severe errors due to a condition that could not be recovered.
<dt>
TEMP
<dd>Condition that was recovered after a number of unsuccessful attempts.
<dt>
UNKN
<dd>Not possible to determine the severity of an error.
<dt>
INFO <b></b>
<dd>This is an informational entry.
</dl>
<dt>
<b>C</b>
<dd>Class of error. The following are the possible error classes.
<dl>
<dt>
H
<dd>Hardware.
<dt>
S
<dd>Software.
<dt>
O
<dd>Informational message.
<dt>
U
<dd>Undetermined.
</dl>
<dt>
<b>RESOURCE_NAME</b>
<dd>Name of the failing resource.
<dt>
<b>DESCRIPTION</b>
<dd>Summary of the error.
</dl>
<p>Using errpt command without a flag will output all the enteries in the log
as shown in the following example. Since the number of error log enteries may
exceed a single page, you can use <tt>errpt|pg</tt> pipe to have a page-wise
view.
<pre>
<b># errpt</b>
IDENTIFIER TIMESTAMP  T C RESOURCE_NAME  DESCRIPTION
0BA49C99   1106154298 T H scsi0          SCSI BUS ERROR
E18E984F   1106110298 P S SRC            SOFTWARE PROGRAM ERROR
2A9F5252   1106094298 P H tok0           WIRE FAULT
E18E984F   1102120498 P S SRC            SOFTWARE PROGRAM ERROR
E18E984F   1101105898 P S SRC            SOFTWARE PROGRAM ERROR
AD331440   1101104498 U S SYSDUMP        SYSTEM DUMP
E18E984F   1030182798 P S SRC            SOFTWARE PROGRAM ERROR
E18E984F   1030182698 P S SRC            SOFTWARE PROGRAM ERROR
E18E984F   1030182598 P S SRC            SOFTWARE PROGRAM ERROR
E18E984F   1023175198 P S SRC            SOFTWARE PROGRAM ERROR
E18E984F   1023175098 P S SRC            SOFTWARE PROGRAM ERROR
E18E984F   1023174898 P S SRC            SOFTWARE PROGRAM ERROR
2A9F5252   1022143498 P H tok0           WIRE FAULT
35BFC499   1022081198 P H hdisk0         DISK OPERATION ERROR
AD331440   1021185998 U S SYSDUMP        SYSTEM DUMP
0BA49C99   1021185798 T H scsi0          SCSI BUS ERROR
35BFC499   1021180298 P H hdisk0         DISK OPERATION ERROR
</pre>
<p>The preceding example shows that the resource name for a disk operation
error is hdisk0. To obtain all the errors with resource name hdisk0 from the
error log, use the <tt>errpt</tt> command with -N flag as shown in the
following example:
<pre>
<b># errpt -N hdisk0</b>
IDENTIFIER TIMESTAMP  T C RESOURCE_NAME  DESCRIPTION
35BFC499   1022081198 P H hdisk0         DISK OPERATION ERROR
35BFC499   1021180298 P H hdisk0         DISK OPERATION ERROR
</pre>

<h4><a name="9pdH13">7.2.1.6  Reading an Error Log Report</a>
</h4>

<p><a name=index747>To</a> read the contents of an error log report, use the
<tt>errpt </tt>command with the -a flag. For example, to read an error log
report with resource name hdisk0, use the <tt>errpt</tt> command with the -a
and -j flags with error identifier as shown in the following sample error
report:
<pre>
<b># errpt -a -j 35BFC499</b>
--------------------------------------------------------------------------
LABEL:          DISK_ERR3
IDENTIFIER:     35BFC499

Date/Time:       Thu Oct 22 08:11:12
Sequence Number: 36
Machine Id:      006151474C00
Node Id:         sv1051c
Class:           H
Type:            PERM
Resource Name:   hdisk0
Resource Class:  disk
Resource Type:   scsd
Location:        04-B0-00-6,0
VPD:
        Manufacturer................IBM
        Machine Type and Model......DORS-32160    !#
        FRU Number..................
        ROS Level and ID............57413345
        Serial Number...............5U5W6388
        EC Level....................85G3685
        Part Number.................07H1132
        Device Specific.(Z0)........000002028F00001A
        Device Specific.(Z1)........39H2916
        Device Specific.(Z2)........0933
        Device Specific.(Z3)........1296
        Device Specific.(Z4)........0001
        Device Specific.(Z5)........16

Description
DISK OPERATION ERROR

Probable Causes
DASD DEVICE
STORAGE DEVICE CABLE

Failure Causes
DISK DRIVE
DISK DRIVE ELECTRONICS
STORAGE DEVICE CABLE

        Recommended Actions
        PERFORM PROBLEM DETERMINATION PROCEDURES

Detail Data
SENSE DATA
0A06 0000 2800 0000 0088 0002 0000 0000 0200 0200 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0001 0001 2FC0

</pre>

<h4><a name="9pdH14">7.2.1.7  Copying an Error Log to Diskette or Tape</a>
</h4>

<p><a name=index751>You</a> may need to send the error log to AIX System
Support Center for analysis. To copy the error log to a diskette, place a
formatted diskette into the diskette drive and use the following commands:
<pre>
ls /var/adm/ras/errlog | backup -ivp
</pre>
<p>To copy the error log to tape, place a tape in the drive and enter:
<pre>
ls /var/adm/ras/errlog | backup -ivpf/dev/rmt0
</pre>

<h4><a name="9pdH15">7.2.1.8  Log Maintenance Activities</a>
</h4>

<p>The <tt>errlogger</tt> <a name=index754>command</a> allows the system
administrator to record messages in the error log. Whenever you perform a
maintenance activity, replace hardware, or apply a software fix, it is a good
idea to record this activity in the system error log.
<p>The following example shows the log enteries before and after a message
(Error Log cleaned) was logged by an operator (using <tt>errlogger</tt>
command) in the error log.
<pre>
<b># errpt</b>
IDENTIFIER TIMESTAMP  T C RESOURCE_NAME  DESCRIPTION
9DBCFDEE   1109164598 T O errdemon       ERROR LOGGING TURNED ON
192AC071   1109164598 T O errdemon       ERROR LOGGING TURNED OFF
<b># errlogger "Error Log cleaned"</b>
<b># errpt</b>
IDENTIFIER TIMESTAMP  T C RESOURCE_NAME  DESCRIPTION
AA8AB241   1109164698 T O OPERATOR       OPERATOR NOTIFICATION
9DBCFDEE   1109164598 T O errdemon       ERROR LOGGING TURNED ON
192AC071   1109164598 T O errdemon       ERROR LOGGING TURNED OFF
</pre>
<p>The identifier <tt>AA8AB241</tt> in the preceding example is the message
record entry with description <tt>OPEARATOR NOTIFICATION</tt>.
<a name="htmlbot"></a>
<p><a href="./5139fm.htm#toc9pdH3"><img src="f2htoc.gif"></a>
<a href="./5139indx.htm"><img src="f2hindex.gif"></a>
<a href="5139c72.htm#htmltop"><img src="f2htop.gif"></a>
<a href="5139c73.htm#htmltop"><img src="f2hnext.gif">7.3  System Dump
Facility</a><br>
</body>
</html>

